# 云主机回收站删除与恢复

云主机回收站功能必须通过配置启用, 启用后针对云平台的所有云主机生效（EayunStack 2.0默认已启用回收站功能）

如用户不需要将云主机放置在回收站, 以后不再使用, 使用`nova force-delete` 强制删除云主机, 云主机不可恢复。参见 本文档前面章节,云主机管理部分的云主机删除。

云主机回收站支持功能分为：

* 云主机软删除
* 云主机软删除查询
* 云主机软删除恢复
* 云主机软删除清除


## 云主机软删除

 云主机通过调用nova delete 放置进入回收站, 回收站的云主机处于SOFT_DELETED状态, 用户配额使用量减少云主机的规格。

 > 云主机软删除方法

 普通用户权限即可删除云主机

 ```
 nova delete 云主机uuid
 ```

 ## 云主机软删除查询

使用admin权限能够查询处于回收站(SOFT_DELETED)状态的云主机

> 云主机软删除查询方法

```
nova list --all-tenants --deleted --status soft_deleted
```


## 云主机软删除恢复

云主机通过nova restore 恢复放置回收站的云主机, 云主机重新启动, 处于ACTIVE状态,用户配额使用量增加恢复的云主机规格。

> 云主机软删除恢复方法

admin 权限根据用户需求进行云主机restore恢复操作

```
nova restore 云主机uuid
```

## 云主机软删除清除

云主机通过nova force-delete 从回收站永久清除指定云主机, 云主机处于DELETED状态, 云主机不能恢复。

云主机从软删除清除方法分为两类：

* admin用户永久清除
* 回收站存储生命周期时间到期, EayunStack 自动清除

> 云主机admin用户永久清除

```
nova force-delete 云主机uuid
```

> 回收站存储周期时间到期， EayunStack 自动清除

云主机删除时间大于回收站存储周期时间, 执行自动清除操作, 无需人员干预。

